// We need the properties plugin to work on both marklogic-client-api and test-app. The 'plugins' Gradle syntax can't be
// used for that. So we have to add the properties plugin to the buildscript classpath and then apply the properties
// plugin via subprojects below.
buildscript {
    repositories {
        maven {
            url "https://plugins.gradle.org/m2/"
        }
    }
    dependencies {
        classpath "net.saliman:gradle-properties-plugin:1.5.2"
    }
}

subprojects {
    apply plugin: "net.saliman.properties"
    apply plugin: 'java'

 	tasks.withType(JavaCompile) {
    	options.encoding = 'UTF-8'
  	}
    sourceCompatibility = "1.8"
    targetCompatibility = "1.8"

    configurations {
        testImplementation.extendsFrom compileOnly
    }

    repositories {
        mavenLocal()
        mavenCentral()
    }

    dependencies {
        testImplementation group: 'junit', name: 'junit', version:'4.13'
        testImplementation group: 'xmlunit', name: 'xmlunit', version:'1.6'
        compileOnly group: 'org.apache.commons', name: 'commons-lang3', version:'3.10'
        compileOnly group: 'org.apache.httpcomponents', name: 'httpclient', version:'4.5.12'
    }

    test {
    	systemProperty "file.encoding", "UTF-8"
        systemProperty "javax.xml.stream.XMLOutputFactory", "com.sun.xml.internal.stream.XMLOutputFactoryImpl"
    }

}
